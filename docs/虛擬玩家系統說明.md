# 🤖 虛擬玩家系統說明

## 📋 系統概述

虛擬玩家系統為遊戲添加了 8 個 AI 電腦玩家，他們會與真人玩家同步進行遊戲，讓排行榜更具競爭性和真實感。

## 👥 虛擬玩家列表

| 排名 | 名稱 | 頭像 | 性格類型 | 技能水平 |
|------|------|------|----------|----------|
| 1 | 麵包大王 | 🐻 | 激進型 | 90% |
| 2 | 甜蛋女帝 | 🐻 | 均衡型 | 85% |
| 3 | 道聽塗熊 | 🐻 | 保守型 | 75% |
| 4 | 樂樂王子 | 🧙 | 激進型 | 80% |
| 5 | 蛋糕女帝 | 🍰 | 均衡型 | 70% |
| 6 | 鮮奶達人 | 👻 | 保守型 | 65% |
| 7 | 司康高手 | 🧙 | 均衡型 | 60% |
| 8 | 奶酪專家 | 🎀 | 保守型 | 55% |

## 🎮 性格類型

### 激進型 (Aggressive)
- **特點**: 偏好高風險高回報的選擇
- **正確率**: 50% + (技能水平 × 40%)
- **代表玩家**: 麵包大王、樂樂王子

### 均衡型 (Balanced)
- **特點**: 平衡風險和回報
- **正確率**: 40% + (技能水平 × 40%)
- **代表玩家**: 甜蛋女帝、蛋糕女帝、司康高手

### 保守型 (Conservative)
- **特點**: 偏好低風險穩定回報
- **正確率**: 30% + (技能水平 × 40%)
- **代表玩家**: 道聽塗熊、鮮奶達人、奶酪專家

## 💾 資料結構

每個虛擬玩家包含以下資料：

```javascript
{
    id: 'vp_xxxx',              // 唯一識別碼
    name: '麵包大王',           // 名稱
    avatar: '🐻',               // 頭像
    personality: 'aggressive',  // 性格類型
    skillLevel: 0.9,           // 技能水平 (0-1)
    resources: {
        honey: 10000,          // 麵包幣
        satisfaction: 100,     // 顧客滿意度
        reputation: 100        // 聲望
    },
    gameProgress: {
        currentRound: 0,       // 當前輪次
        eventsCompleted: 0,    // 完成事件數
        selectedRegion: null,  // 選擇的地區
        selectedDistrict: null // 選擇的行政區
    },
    stats: {
        totalEarnings: 0,      // 總收益
        totalSpending: 0,      // 總支出
        correctAnswers: 0,     // 正確答案數
        wrongAnswers: 0        // 錯誤答案數
    }
}
```

## 🔄 運作流程

### 1. 初始化
遊戲載入時自動初始化虛擬玩家系統：
- 檢查 `localStorage` 是否有已存在的虛擬玩家資料
- 如果沒有，創建 8 個新的虛擬玩家
- 所有虛擬玩家初始資源與真人玩家相同

### 2. 同步遊戲
當真人玩家完成一個事件時：
1. 系統觸發 `GameFlowManager.completeEvent()`
2. 自動調用 `VirtualPlayersSystem.simulateRound(event)`
3. 每個虛擬玩家根據性格和技能做出選擇
4. 應用選擇結果到虛擬玩家的資源

### 3. 排行榜整合
當玩家打開排行榜時：
- 系統獲取真人玩家的資源
- 合併虛擬玩家資料
- 根據選擇的排行榜類型排序：
  - 🍯 麵包幣排行榜
  - 😊 顧客滿意度排行榜
  - 🏆 聲望排行榜
- 顯示前 8 名（真人玩家標記為 👤）

### 4. 資料持久化
- 虛擬玩家資料儲存在 `localStorage`
- 鍵名: `virtualPlayers`
- 每次資源變化後自動儲存

## 🛠️ 開發者工具

### 查看虛擬玩家狀態
在瀏覽器控制台輸入：
```javascript
showVirtualPlayers()
```

輸出範例：
```
=== 🤖 虛擬玩家狀態 ===

【1】 🐻 麵包大王
   性格: aggressive | 技能: 90%
   💰 麵包幣: 12,500
   😊 滿意度: 95%
   🏆 聲望: 150
   📊 進度: 輪次 1 | 完成 3 事件
   ✅ 正確: 2 | ❌ 錯誤: 1

【2】 🐻 甜蛋女帝
   性格: balanced | 技能: 85%
   💰 麵包幣: 11,800
   ...
```

### 重置虛擬玩家
```javascript
VirtualPlayersSystem.resetAllPlayers()
```

### 手動模擬一輪
```javascript
VirtualPlayersSystem.simulateRound(event)
```

## 🎯 AI 決策邏輯

### 選擇流程
1. 獲取當前事件的所有選項
2. 根據性格類型選擇策略：
   - **激進型**: 優先選擇正確答案（高正確率）
   - **均衡型**: 中等正確率
   - **保守型**: 較低正確率（模擬新手玩家）
3. 基於技能水平調整正確率
4. 隨機決定是否選對

### 效果應用
- **選對**: 獲得完整效果
- **選錯**: 獲得 50% 效果
- 資源不會低於 0
- 滿意度限制在 0-100 之間

## 📊 排行榜顯示

### 前三名
- 第一名：金色背景 + 👑 圖標
- 第二名：銀色背景 + 🥈 圖標
- 第三名：橙色背景 + 🥉 圖標
- 真人玩家額外顯示 👤 標記

### 第 4-8 名
- 顯示在列表中
- 包含頭像、名稱和分數
- 真人玩家標記為 "👤 我"

## 🔧 技術細節

### 儲存位置
- `localStorage.virtualPlayers` - 虛擬玩家資料

### 全局變數
- `window.VirtualPlayersSystem` - 虛擬玩家系統主物件

### 相依系統
- `GameResources` - 獲取真人玩家資源
- `GameFlowManager` - 遊戲流程管理
- `EventFlowManager` - 事件流程管理
- `LeaderboardModal` - 排行榜顯示

## 🚀 未來擴展

可能的擴展功能：
1. 更多虛擬玩家
2. 動態難度調整
3. 虛擬玩家對話系統
4. 成就解鎖
5. 虛擬玩家 AI 學習能力
6. 多人對戰模式

## 📝 注意事項

1. 虛擬玩家資料會隨遊戲進行而改變
2. 重置真人玩家時也會重置虛擬玩家
3. 虛擬玩家不會進行進貨操作
4. 排行榜實時反映當前狀態
5. 關閉瀏覽器後資料保留（localStorage）

## 🎮 遊戲平衡

技能水平分布設計讓玩家有機會：
- 與高手競爭（90%技能）
- 超越普通玩家（70-80%技能）
- 輕鬆領先新手（55-65%技能）

這樣確保遊戲既有挑戰性，又不會過於困難！

